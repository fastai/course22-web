<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.451">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Practical Deep Learning for Coders - Part 2 overview</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Lessons/lesson9.html" rel="next">
<link href="../Lessons/Summaries/lesson8.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Practical Deep Learning for Coders - Part 2 overview">
<meta property="og:description" content="Learn Deep Learning with fastai and PyTorch, 2022">
<meta property="og:image" content="/images/course2022p2l1.jpg">
<meta property="og:site_name" content="Practical Deep Learning for Coders">
<meta name="twitter:title" content="Practical Deep Learning for Coders - Part 2 overview">
<meta name="twitter:description" content="Learn Deep Learning with fastai and PyTorch, 2022">
<meta name="twitter:image" content="/images/course2022p2l1.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Practical Deep Learning for Coders</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/fastai/course22"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Lessons/part2.html">Part 2</a></li><li class="breadcrumb-item"><a href="../Lessons/part2.html">Part 2 overview</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Practical Deep Learning</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Part 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1: Getting started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2: Deployment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3: Neural net foundations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4: Natural Language (NLP)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5: From-scratch model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6: Random forests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7: Collaborative filtering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8: Convolutions (CNNs)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson8a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bonus: Data ethics</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Summaries</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/Summaries/lesson1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/Summaries/lesson2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/Summaries/lesson3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/Summaries/lesson4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/Summaries/lesson5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/Summaries/lesson6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/Summaries/lesson7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/Summaries/lesson8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 8</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Part 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/part2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Part 2 overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9: Stable Diffusion</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10: Diving Deeper</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11: Matrix multiplication</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12: Mean shift clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13: Backpropagation &amp; MLP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14: Backpropagation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15: Autoencoders</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16: The Learner framework</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17: Initialization/normalization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">18: Accelerated SGD &amp; ResNets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">19: DDPM and Dropout</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">20: Mixed Precision</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">21: DDIM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">22: Karras et al (2022)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">23: Super-resolution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">24: Attention &amp; transformers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Lessons/lesson25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">25: Latent diffusion</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://youtu.be/0_BBRNYInx8" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bonus: Lesson 9a</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://youtu.be/mYpjmM7O-30" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bonus: Lesson 9b</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Resources/book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The book</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Resources/forums.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Forums</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Resources/kaggle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kaggle</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Resources/testimonials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testimonials</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#content-summary" id="toc-content-summary" class="nav-link active" data-scroll-target="#content-summary">Content summary</a></li>
  <li><a href="#topics-covered" id="toc-topics-covered" class="nav-link" data-scroll-target="#topics-covered">Topics covered</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/fastai/course22-web/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Lessons/part2.html">Part 2</a></li><li class="breadcrumb-item"><a href="../Lessons/part2.html">Part 2 overview</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Part 2 overview</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this course, containing over 30 hours of video content, we implement the astounding <a href="https://stability.ai/blog/stable-diffusion-public-release">Stable Diffusion</a> algorithm from scratch! That’s the <a href="https://www.pcworld.com/article/916785/creating-ai-art-local-pc-stable-diffusion.html">killer app</a> that made the <a href="https://devops.com/stable-diffusion-public-richixbw/">internet freak out</a>, and caused the media to say “<a href="https://arstechnica.com/information-technology/2022/09/with-stable-diffusion-you-may-never-believe-what-you-see-online-again/">you may never believe what you see online again</a>”.</p>
<p>We’ve worked closely with experts from Stability.ai and Hugging Face (creators of the Diffusers library) to ensure we have rigorous coverage of the latest techniques. The course includes coverage of papers that were released after Stable Diffusion came out – so it actually goes well beyond even what Stable Diffusion includes! We also explain how to read research papers, and practice this skill by studying and implementing many papers throughout the course.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="diffusion.png" class="border preview-image img-fluid figure-img"></p>
<figcaption>Stable diffusion generated image</figcaption>
</figure>
</div>
<p>Stable diffusion, and diffusion methods in general, are a great learning goal for many reasons. For one thing, of course, you can create amazing stuff with these algorithms! To really take the technique to the next level, and create things that no-one has seen before, you need to really deeply understand what’s happening under the hood. With this understanding, you can craft your own loss functions, initialization methods, multi-model mixups, and more, to create totally new applications that have never been seen before. Just as important: it’s a great learning goal because nearly every key technique in modern deep learning comes together in these methods. Contrastive learning, transformer models, auto-encoders, CLIP embeddings, latent variables, u-nets, resnets, and much more are involved in creating a single image.</p>
<p>To get the most out of this course, you should be a reasonably confident deep learning practitioner. If you’ve finished fast.ai’s <a href="https://course.fast.ai/">Practical Deep Learning</a> course then you’ll be ready! If you haven’t done that course, but are comfortable with building an SGD training loop from scratch in Python, being competitive in Kaggle competitions, using modern NLP and computer vision algorithms for practical problems, and working with PyTorch and fastai, then you will be ready to start the course. (If you’re not sure, then we strongly recommend getting starting with <em>Practical Deep Learning</em>.)</p>
<blockquote class="blockquote">
<p><a href="../Lessons/lesson9.html">Get started</a> now!</p>
</blockquote>
<section id="content-summary" class="level2">
<h2 class="anchored" data-anchor-id="content-summary">Content summary</h2>
<p>In this course, we’ll explore diffusion methods such as Denoising Diffusion Probabilistic Models (DDPM) and Denoising Diffusion Implicit Models (DDIM). We’ll get our hands dirty implementing unconditional and conditional diffusion models, experimenting with different samplers, and diving into recent tricks like textual inversion and Dreambooth.</p>
<p>Along the way, we’ll cover essential deep learning topics like neural network architectures, data augmentation approaches, and various loss functions. We’ll build our own models from scratch, such as Multi-Layer Perceptrons (MLPs), ResNets, and Unets, while experimenting with generative architectures like autoencoders and transformers.</p>
<p>Throughout the course, we’ll use PyTorch to implement our models, and will create our own deep learning framework called <code>miniai</code>. We’ll master Python concepts like iterators, generators, and decorators to keep our code clean and efficient. We’ll also explore deep learning optimizers like stochastic gradient descent (SGD) accelerated approaches, learning rate annealing, and learning how to experiment with the impact different initialisers, batch sizes and learning rates. And of course, we’ll make use of handy tools like the Python debugger (pdb) and nbdev for building Python modules from Jupyter notebooks.</p>
<p>Lastly, we’ll touch on fundamental concepts like tensors, calculus, and pseudo-random number generation to provide a solid foundation for our exploration. We’ll apply these concepts to machine learning techniques like mean shift clustering and convolutional neural networks (CNNs), and will see how to use tracking with Weights and Biases (W&amp;B).</p>
<p>We’ll also tackle mixed precision training using both NVIDIA’s apex library, and the Accelerate library from Hugging Face. We’ll investigate various types of normalization like Layer Normalization and Batch Normalization. By the end of the course, you’ll have a deep understanding of diffusion models and the skills to implement cutting-edge deep learning techniques.</p>
<blockquote class="blockquote">
<p><a href="../Lessons/lesson9.html">Get started</a> now!</p>
</blockquote>
</section>
<section id="topics-covered" class="level2">
<h2 class="anchored" data-anchor-id="topics-covered">Topics covered</h2>
<p>Here’s a list of all the stuff that you’ll learn in detail and build from scratch in this course. (When we say “from scratch”, we mean that you’ll rely on nothing other than Python and its standard library.)</p>
<ul>
<li>Diffusion foundations
<ul>
<li>Denoising Diffusion Probabilistic Models (DDPM)
<ul>
<li>Forward and reverse processes</li>
<li>Implementing a noise prediction model using a neural network</li>
<li>Visualizing noisy images at different timesteps</li>
</ul></li>
<li>Denoising Diffusion Implicit Model (DDIM)
<ul>
<li>DDPM/DDIM improvements</li>
<li>Alternative noise schedules</li>
</ul></li>
<li>Pre-conditioning</li>
<li>Implementation and performance of different samplers
<ul>
<li>Euler sampler</li>
<li>Ancestral Euler sampler</li>
<li>Heuns method</li>
<li>LMS sampler</li>
</ul></li>
<li>Implementing an unconditional stable diffusion model</li>
<li>Creating a conditional stable diffusion model</li>
<li>Inverse problems
<ul>
<li>Textual inversion</li>
<li>Dreambooth</li>
</ul></li>
</ul></li>
<li>Hugging Face’s Diffusers library
<ul>
<li>Pre-trained pipelines</li>
<li>Image-to-image pipelines</li>
<li>Guidance scale</li>
<li>Negative prompts</li>
<li>Callbacks</li>
<li>Working with Hugging Face datasets</li>
</ul></li>
<li>Deep learning optimizers
<ul>
<li>Stochastic gradient descent (SGD) accelerated approaches
<ul>
<li>Momentum</li>
<li>RMSProp</li>
<li>Adam</li>
</ul></li>
<li>Learning rate annealing
<ul>
<li>PyTorch learning rate schedulers
<ul>
<li>Cosine Annealing</li>
<li>OneCycleLR</li>
</ul></li>
</ul></li>
<li>Experimenting with batch sizes and learning rates</li>
<li>Working with PyTorch optimizers</li>
</ul></li>
<li>Python concepts
<ul>
<li>Organizing and simplifying code</li>
<li>Iterators and generators in Python</li>
<li>Dunder methods</li>
<li>Python data model</li>
<li>Python debugger (pdb)</li>
<li>Using nbdev to create Python modules from Jupyter notebooks</li>
<li>try-except blocks</li>
<li>decorators</li>
<li>getattr</li>
<li><code>**kwargs</code> and delegates</li>
</ul></li>
<li>Basic foundations
<ul>
<li>Tensors
<ul>
<li>Linear classifier using a tensor</li>
<li>Matrix multiplication using Python and Numba</li>
<li>Comparing APL with PyTorch</li>
<li>Frobenius norm</li>
<li>Broadcasting in deep learning and machine learning code</li>
<li>Matrix multiplication</li>
<li>Einstein summation notation and <code>torch.einsum</code></li>
<li>GPU acceleration and CUDA</li>
<li>Numba</li>
</ul></li>
<li>Calculus
<ul>
<li>Derivatives and Infinitesimals</li>
<li>Finite differencing</li>
<li>Analytic derivatives</li>
</ul></li>
<li>Loss functions
<ul>
<li>Contrastive loss function</li>
<li>Perceptual loss</li>
<li><code>log_softmax()</code> function and cross entropy loss</li>
</ul></li>
<li>Pseudo-random number generation
<ul>
<li>Wickman-Hill algorithm</li>
<li>Random state in deep learning</li>
</ul></li>
</ul></li>
<li>Neural network architectures
<ul>
<li>Multi-Layer Perceptron (MLP) implementation</li>
<li>Gradients and derivatives</li>
<li>Chain rule and backpropagation</li>
<li>PyTorch for calculating derivatives</li>
<li>ReLU and linear function classes</li>
<li>ResNets</li>
<li>Generative architectures
<ul>
<li>Autoencoders
<ul>
<li>Convolutional autoencoders</li>
<li>Variational autoencoders</li>
</ul></li>
<li>Unets
<ul>
<li>Experimenting with cross connections in Unets</li>
</ul></li>
<li>CLIP text encoders and image encoders</li>
<li>Transformers
<ul>
<li>Self-attention and multi-headed attention</li>
<li>Rearrange function</li>
<li>Time embedding and sinusoidal embeddings</li>
</ul></li>
<li>Creating a super-resolution U-Net model</li>
<li>Gradually unfreezing pre-trained networks</li>
<li>Style transfer
<ul>
<li>Content loss</li>
<li>Gram Matrix</li>
</ul></li>
<li>Neural Cellular Automata
<ul>
<li>Circular padding</li>
<li>Gradient normalization</li>
</ul></li>
</ul></li>
</ul></li>
<li>Deep learning techniques
<ul>
<li>Data augmentation techniques
<ul>
<li>Random erasing</li>
<li>TrivialAugment</li>
<li>Test time augmentation</li>
</ul></li>
<li>Dropout for improving model performance
<ul>
<li>Test time dropout for measuring model confidence</li>
</ul></li>
</ul></li>
<li>PyTorch
<ul>
<li>PyTorch’s <code>nn.Module</code> and <code>nn.Sequential</code>
<ul>
<li>Creating custom PyTorch modules</li>
<li>Implementing optimizers, DataLoaders, and Datasets</li>
</ul></li>
<li>PyTorch hooks</li>
</ul></li>
<li>Learner framework
<ul>
<li>Building a flexible training framework</li>
<li>Callbacks and exceptions (CancelFitException, CancelEpochException, CancelBatchException)</li>
<li>Metrics and MetricsCB callback</li>
<li>DeviceCB callback</li>
<li>Refactoring code with context managers</li>
<li>set_seed function</li>
<li>Callback class and TrainLearner subclass</li>
<li>HooksCallback and ActivationStats</li>
<li>Experimenting with batch sizes and learning rates</li>
<li>torcheval library</li>
</ul></li>
<li>Machine Learning Techniques and Tools
<ul>
<li>Mean shift clustering</li>
<li>Gaussian kernel</li>
<li>Norms</li>
<li>Log sum exp trick</li>
<li>Convolutional Neural Networks (CNNs)
<ul>
<li>Convolutions and kernels</li>
<li>Im2col technique</li>
<li>Padding and stride in CNNs</li>
<li>Receptive field</li>
<li>Building a CNN from scratch</li>
</ul></li>
<li>Weights and Biases (W&amp;B) for experiment tracking
<ul>
<li>Fréchet Inception Distance (FID) metric</li>
<li>Kernel Inception Distance (KID) metric</li>
</ul></li>
<li>Mixed precision training
<ul>
<li>Accelerate library from HuggingFace</li>
<li>Collation function</li>
</ul></li>
<li>Initialization and normalization
<ul>
<li>Histograms of activations</li>
<li>Glorot (Xavier) initialization</li>
<li>Variance, standard deviation, and covariance</li>
<li>General ReLU activation function</li>
<li>Layer-wise Sequential Unit Variance (LSUV)</li>
<li>Layer Normalization and Batch Normalization</li>
<li>Instance Norm and Group Norm</li>
</ul></li>
</ul></li>
</ul>
<blockquote class="blockquote">
<p><a href="../Lessons/lesson9.html">Get started</a> now!</p>
</blockquote>
<p>(The “topics covered” list was taken from the concatenation of the topic list of each lesson, and using GPT 4 with this prompt: “<em>The input text contains a markdown list of topics discussed in a number of deep learning and stable diffusion lessons. The topics from each lesson were concatenated together into this list, therefore it may contain duplicates (or near dupes) and is not well organised. Create an organised markdown list which groups similar topics together (using a hierarchy or markdown list items as appropriate) and combine duplicate or very similar topics.</em>” The “content summary” section was taken from the “topics covered” list, and the GPT 4 prompt “<em>Summarise the following markdown course outline using 3-4 paragraphs of informal prose in the style of Jeremy Howard. Do not follow the same order as the topics in the outline, but instead arrange them such that the most foundational and key topics come first.</em>”)</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../Lessons/Summaries/lesson8.html" class="pagination-link  aria-label=" lesson="" 8"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Lesson 8</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Lessons/lesson9.html" class="pagination-link" aria-label="9: Stable Diffusion">
        <span class="nav-page-text">9: Stable Diffusion</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>