<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.451">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Practical Deep Learning for Coders - Lesson 7</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../Lessons/Summaries/lesson8.html" rel="next">
<link href="../../Lessons/Summaries/lesson6.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Practical Deep Learning for Coders - Lesson 7">
<meta property="og:description" content="Learn Deep Learning with fastai and PyTorch, 2022">
<meta property="og:site_name" content="Practical Deep Learning for Coders">
<meta name="twitter:title" content="Practical Deep Learning for Coders - Lesson 7">
<meta name="twitter:description" content="Learn Deep Learning with fastai and PyTorch, 2022">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Practical Deep Learning for Coders</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/fastai/course22"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../Lessons/lesson1.html">Part 1</a></li><li class="breadcrumb-item"><a href="../../Lessons/Summaries/lesson1.html">Summaries</a></li><li class="breadcrumb-item"><a href="../../Lessons/Summaries/lesson7.html">Lesson 7</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Practical Deep Learning</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Part 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1: Getting started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2: Deployment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3: Neural net foundations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4: Natural Language (NLP)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5: From-scratch model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6: Random forests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7: Collaborative filtering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8: Convolutions (CNNs)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson8a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bonus: Data ethics</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Summaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/Summaries/lesson1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/Summaries/lesson2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/Summaries/lesson3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/Summaries/lesson4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/Summaries/lesson5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/Summaries/lesson6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/Summaries/lesson7.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Lesson 7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/Summaries/lesson8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lesson 8</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Part 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 2 overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9: Stable Diffusion</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10: Diving Deeper</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11: Matrix multiplication</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12: Mean shift clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13: Backpropagation &amp; MLP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14: Backpropagation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15: Autoencoders</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16: The Learner framework</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17: Initialization/normalization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">18: Accelerated SGD &amp; ResNets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">19: DDPM and Dropout</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">20: Mixed Precision</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">21: DDIM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">22: Karras et al (2022)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">23: Super-resolution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">24: Attention &amp; transformers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lessons/lesson25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">25: Latent diffusion</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://youtu.be/0_BBRNYInx8" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bonus: Lesson 9a</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://youtu.be/mYpjmM7O-30" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bonus: Lesson 9b</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Resources/book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The book</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Resources/forums.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Forums</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Resources/kaggle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kaggle</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Resources/testimonials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testimonials</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#gradient-accumulation-and-gpu-memory" id="toc-gradient-accumulation-and-gpu-memory" class="nav-link active" data-scroll-target="#gradient-accumulation-and-gpu-memory">Gradient accumulation and GPU memory</a></li>
  <li><a href="#creating-an-ensemble" id="toc-creating-an-ensemble" class="nav-link" data-scroll-target="#creating-an-ensemble">Creating an ensemble</a></li>
  <li><a href="#multi-target-model" id="toc-multi-target-model" class="nav-link" data-scroll-target="#multi-target-model">Multi-target model</a></li>
  <li><a href="#cross-entropy-and-softmax" id="toc-cross-entropy-and-softmax" class="nav-link" data-scroll-target="#cross-entropy-and-softmax">Cross-entropy and softmax</a></li>
  <li><a href="#multi-target-activations" id="toc-multi-target-activations" class="nav-link" data-scroll-target="#multi-target-activations">Multi-target activations</a></li>
  <li><a href="#collaborative-filtering" id="toc-collaborative-filtering" class="nav-link" data-scroll-target="#collaborative-filtering">Collaborative filtering</a></li>
  <li><a href="#embeddings" id="toc-embeddings" class="nav-link" data-scroll-target="#embeddings">Embeddings</a></li>
  <li><a href="#object-oriented-programming" id="toc-object-oriented-programming" class="nav-link" data-scroll-target="#object-oriented-programming">Object oriented programming</a></li>
  <li><a href="#improving-collaborative-filtering" id="toc-improving-collaborative-filtering" class="nav-link" data-scroll-target="#improving-collaborative-filtering">Improving collaborative filtering</a></li>
  <li><a href="#weight-decay" id="toc-weight-decay" class="nav-link" data-scroll-target="#weight-decay">Weight decay</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/fastai/course22-web/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../Lessons/lesson1.html">Part 1</a></li><li class="breadcrumb-item"><a href="../../Lessons/Summaries/lesson1.html">Summaries</a></li><li class="breadcrumb-item"><a href="../../Lessons/Summaries/lesson7.html">Lesson 7</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Lesson 7</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="gradient-accumulation-and-gpu-memory" class="level2">
<h2 class="anchored" data-anchor-id="gradient-accumulation-and-gpu-memory">Gradient accumulation and GPU memory</h2>
<ul>
<li>We have explored the simplest neural net with fully connected linear layers in earlier lectures. In this lecture we will focus on tweaking first and last layers, in the next few weeks on tweaking middle part of the neuralnet.</li>
<li>Review of the notebook <em>Road to Top part 2</em> and congrats to fastai students beat Jeremy on 1st and 2nd</li>
<li>What are the benefits of using larger models? What are the problems of larger models? (use up GPU memory as GPU is not as clever as CPU to find ways to free itself; so large model needs very expensive GPU) What can we do about it when GPU out of memory? first, to restart the notebook; then Jeremy is about to show us a trick to enable us to train extra large models on Kaggle, Wow!</li>
<li>How big is Kaggle GPU? Do you have to run notebooks on kaggle sometimes for example code competitions? Why it is good and fair to use Kaggle notebook to win leaderboard?</li>
<li>How did Jeremy use a 24G GPU to find out what can a 16G GPU do? How did Jeremy find out how much GPU memory will a model use? How did Jeremy choose the smallest subgroup of images as the training set? Will training the model longer take up more memory? (No) So, smallest training set + 1 epoch training can quickly tell us how much memory is needed for the model.</li>
<li>Jeremy then trained different models to see how much memories they used up. How much memory does convnext-small model take? Which line of code does Jeremy use to find out the GPU memory used up by the model? Which two lines of code does Jeremy use to free unnecssarily occupied memories GPU so that you don’t need to restart the kernel to run the next model?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/1/8/1873321e4fc2c4572c625303180eec7843967dbb_2_690x210.png" alt="gc" width="690" height="210" srcset="https://forums.fast.ai/uploads/default/optimized/3X/1/8/1873321e4fc2c4572c625303180eec7843967dbb_2_690x210.png, https://forums.fast.ai/uploads/default/optimized/3X/1/8/1873321e4fc2c4572c625303180eec7843967dbb_2_1035x315.png 1.5x, https://forums.fast.ai/uploads/default/original/3X/1/8/1873321e4fc2c4572c625303180eec7843967dbb.png 2x"></p>
<ul>
<li>What if a model causes a crash problem of cuda out of memory? What is GradientAccumulation? What is integer divide? (<code>//</code>).</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/2/6/26d7b272d6e0d5a3a2802981037cba31124bdd43_2_690x230.jpeg" alt="gradientaccumulation" width="690" height="230" srcset="https://forums.fast.ai/uploads/default/optimized/3X/2/6/26d7b272d6e0d5a3a2802981037cba31124bdd43_2_690x230.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/2/6/26d7b272d6e0d5a3a2802981037cba31124bdd43_2_1035x345.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/2/6/26d7b272d6e0d5a3a2802981037cba31124bdd43_2_1380x460.jpeg 2x"></p>
<ul>
<li>What is the problem of using smaller batch size? (smaller batch size, larger volatility of learning rate and weights) How can we make the model train in smaller batch size as if it is in large batch size? How to explain GradientAccumulation in code?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/5/f/5f5de3dc9a36ce6ef7bb0413df0816afad42742f_2_690x158.png" alt="training-loop-without-gradientaccumulation" width="690" height="158" srcset="https://forums.fast.ai/uploads/default/optimized/3X/5/f/5f5de3dc9a36ce6ef7bb0413df0816afad42742f_2_690x158.png, https://forums.fast.ai/uploads/default/optimized/3X/5/f/5f5de3dc9a36ce6ef7bb0413df0816afad42742f_2_1035x237.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/5/f/5f5de3dc9a36ce6ef7bb0413df0816afad42742f_2_1380x316.png 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/f/9/f9daf4e38da769cb3de7a0c8cdf20c74fd8d18b7_2_690x210.jpeg" alt="gradientaccumulation-explained" width="690" height="210" srcset="https://forums.fast.ai/uploads/default/optimized/3X/f/9/f9daf4e38da769cb3de7a0c8cdf20c74fd8d18b7_2_690x210.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/f/9/f9daf4e38da769cb3de7a0c8cdf20c74fd8d18b7_2_1035x315.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/f/9/f9daf4e38da769cb3de7a0c8cdf20c74fd8d18b7_2_1380x420.jpeg 2x"></p>
<ul>
<li>What is the implication of using GradientAccumulation? How much difference is the numeric result between using GradientAccumulation and not? What is the main cause for the difference?</li>
<li>More questions: it should be <code>count &amp;gt;= 64</code> in the code above when doing GradientAccumulation; <code>lr_find</code> uses batch size from the DataLoader;</li>
<li>Why not just use a smaller batch size instead of GradientAccumulation? What is the rule of thumb for picking batch sizes? How about adjusting learning rate according to the batch size?</li>
<li>How did Jeremy use GradientAccumulation to find out how many <code>accum</code> is needed to run those large models on Kaggle’s 16G GPUs? (<code>accum=1</code> always out of memory, but <code>accum=2</code> works for all large models).</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/c/c/cc4d36bc34d4f4d1c313b96cdf252b9e6c9ac33d_2_690x81.png" alt="gradientaccumulation-large-models" width="690" height="81" srcset="https://forums.fast.ai/uploads/default/optimized/3X/c/c/cc4d36bc34d4f4d1c313b96cdf252b9e6c9ac33d_2_690x81.png, https://forums.fast.ai/uploads/default/optimized/3X/c/c/cc4d36bc34d4f4d1c313b96cdf252b9e6c9ac33d_2_1035x121.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/c/c/cc4d36bc34d4f4d1c313b96cdf252b9e6c9ac33d_2_1380x162.png 2x"></p>
</section>
<section id="creating-an-ensemble" class="level2">
<h2 class="anchored" data-anchor-id="creating-an-ensemble">Creating an ensemble</h2>
<ul>
<li>How did Jeremy put all the models and their settings together for experimenting later? Do we have to use the size of the model’s specification for now and how about in the future?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/2/b/2bac3e816fa5bb631ba278430031a9561b3fffbc_2_665x500.jpeg" alt="models-testing" width="665" height="500" srcset="https://forums.fast.ai/uploads/default/optimized/3X/2/b/2bac3e816fa5bb631ba278430031a9561b3fffbc_2_665x500.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/2/b/2bac3e816fa5bb631ba278430031a9561b3fffbc_2_997x750.jpeg 1.5x, https://forums.fast.ai/uploads/default/original/3X/2/b/2bac3e816fa5bb631ba278430031a9561b3fffbc.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/2/a/2a249910c04e58ec006290f08688e7b0f8aeea81_2_690x56.png" alt="training-set-images" width="690" height="56" srcset="https://forums.fast.ai/uploads/default/optimized/3X/2/a/2a249910c04e58ec006290f08688e7b0f8aeea81_2_690x56.png, https://forums.fast.ai/uploads/default/optimized/3X/2/a/2a249910c04e58ec006290f08688e7b0f8aeea81_2_1035x84.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/2/a/2a249910c04e58ec006290f08688e7b0f8aeea81_2_1380x112.png 2x"></p>
<ul>
<li>How to run all the models with specifications without running out of memory</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/a/e/ae921c0da2bf64fe0e3d890f7cf3effe0e8369d5_2_690x304.jpeg" alt="run-all-models-without-out-memory" width="690" height="304" srcset="https://forums.fast.ai/uploads/default/optimized/3X/a/e/ae921c0da2bf64fe0e3d890f7cf3effe0e8369d5_2_690x304.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/a/e/ae921c0da2bf64fe0e3d890f7cf3effe0e8369d5_2_1035x456.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/a/e/ae921c0da2bf64fe0e3d890f7cf3effe0e8369d5_2_1380x608.jpeg 2x"></p>
<ul>
<li>Why does Jeremy don’t use <code>seed=42</code> here in training? What is the effect?</li>
<li>What is ensemble or bagging of different good deep learning architectures? Why it is useful?</li>
<li>How to do the ensemble of different deep learning models?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/e/2/e2960f76f91dcb5e888127e89ce267d08a6eb1bb_2_690x349.jpeg" alt="ensemble1" width="690" height="349" srcset="https://forums.fast.ai/uploads/default/optimized/3X/e/2/e2960f76f91dcb5e888127e89ce267d08a6eb1bb_2_690x349.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/e/2/e2960f76f91dcb5e888127e89ce267d08a6eb1bb_2_1035x523.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/e/2/e2960f76f91dcb5e888127e89ce267d08a6eb1bb_2_1380x698.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/4/3/43a6e2e47b5d49d201353fff1b15279f149b8d08_2_690x295.jpeg" alt="ensemble2" width="690" height="295" srcset="https://forums.fast.ai/uploads/default/optimized/3X/4/3/43a6e2e47b5d49d201353fff1b15279f149b8d08_2_690x295.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/4/3/43a6e2e47b5d49d201353fff1b15279f149b8d08_2_1035x442.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/4/3/43a6e2e47b5d49d201353fff1b15279f149b8d08_2_1380x590.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/4/5/45548cc497f861df5b5c4a1234bc17aee41d7cee_2_690x317.jpeg" alt="ensemble3" width="690" height="317" srcset="https://forums.fast.ai/uploads/default/optimized/3X/4/5/45548cc497f861df5b5c4a1234bc17aee41d7cee_2_690x317.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/4/5/45548cc497f861df5b5c4a1234bc17aee41d7cee_2_1035x475.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/4/5/45548cc497f861df5b5c4a1234bc17aee41d7cee_2_1380x634.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/5/1/51f580a36eab28daedbb68779840e1963c85f03b_2_690x183.png" alt="ensemble4" width="690" height="183" srcset="https://forums.fast.ai/uploads/default/optimized/3X/5/1/51f580a36eab28daedbb68779840e1963c85f03b_2_690x183.png, https://forums.fast.ai/uploads/default/optimized/3X/5/1/51f580a36eab28daedbb68779840e1963c85f03b_2_1035x274.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/5/1/51f580a36eab28daedbb68779840e1963c85f03b_2_1380x366.png 2x"></p>
<ul>
<li>Why should we improve and submit to Kaggle everyday? How the submission history can help trace your models developments and improvement?</li>
<li>More questions: What is k-fold cross-validation and how can it be applied in this case? Why does Jeremy don’t use it?</li>
<li>Are there any drawbacks of GradientAccumulation? Any GPU recommendations?</li>
<li>In part 2 Jeremy may cover how to train a smaller model to do well as in large models for faster inference</li>
</ul>
</section>
<section id="multi-target-model" class="level2">
<h2 class="anchored" data-anchor-id="multi-target-model">Multi-target model</h2>
<ul>
<li>How to set the data split and item and batch transformations?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/6/7/6708adef38cb0f664442d2e9e3f846fda75a045d_2_690x235.png" alt="datablock-2-labels" width="690" height="235" srcset="https://forums.fast.ai/uploads/default/optimized/3X/6/7/6708adef38cb0f664442d2e9e3f846fda75a045d_2_690x235.png, https://forums.fast.ai/uploads/default/optimized/3X/6/7/6708adef38cb0f664442d2e9e3f846fda75a045d_2_1035x352.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/6/7/6708adef38cb0f664442d2e9e3f846fda75a045d_2_1380x470.png 2x"></p>
<ul>
<li>How to create a model to predict both disease and variety types? Can we see predicting both disease and variety in terms of predicting 20 things, 10 for disease, 10 for variety?</li>
<li>What does the new model (and new dataloaders) need now to make predictions on disease?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/4/8/48c068723f1b2f8c4205d02c96d9f5d6e2d65189_2_690x254.jpeg" alt="new-disease-error-rate-loss" width="690" height="254" srcset="https://forums.fast.ai/uploads/default/optimized/3X/4/8/48c068723f1b2f8c4205d02c96d9f5d6e2d65189_2_690x254.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/4/8/48c068723f1b2f8c4205d02c96d9f5d6e2d65189_2_1035x381.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/4/8/48c068723f1b2f8c4205d02c96d9f5d6e2d65189_2_1380x508.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/4/e/4ee51a1545b8b3f3d8ea0a0b485d45dddc1a2a90_2_690x159.png" alt="new-model" width="690" height="159" srcset="https://forums.fast.ai/uploads/default/optimized/3X/4/e/4ee51a1545b8b3f3d8ea0a0b485d45dddc1a2a90_2_690x159.png, https://forums.fast.ai/uploads/default/optimized/3X/4/e/4ee51a1545b8b3f3d8ea0a0b485d45dddc1a2a90_2_1035x238.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/4/e/4ee51a1545b8b3f3d8ea0a0b485d45dddc1a2a90_2_1380x318.png 2x"></p>
<ul>
<li>When and how to provide our own loss function? fastai can detect appropriate loss for your datalaoders and use it by default in simple cases. In this special case, How do we create and use our custom loss for the new model?</li>
</ul>
</section>
<section id="cross-entropy-and-softmax" class="level2">
<h2 class="anchored" data-anchor-id="cross-entropy-and-softmax">Cross-entropy and softmax</h2>
<ul>
<li>What does <code>F.cross_entropy</code> do exactly? This function belong to the first and last layer, therefore we must understand them. What is the raw output of the model of predicting 5 things?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/5/6/563e70daa1930078e47617c7c2db3897446f3848_2_544x500.jpeg" alt="softmax1" width="544" height="500" srcset="https://forums.fast.ai/uploads/default/optimized/3X/5/6/563e70daa1930078e47617c7c2db3897446f3848_2_544x500.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/5/6/563e70daa1930078e47617c7c2db3897446f3848_2_816x750.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/5/6/563e70daa1930078e47617c7c2db3897446f3848_2_1088x1000.jpeg 2x"></p>
<ul>
<li>What is the formula of softmax and How to calculate it in the spreadsheet?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/0/b/0bee952ff080de7e7b050fa9e81dd483414da494_2_645x500.jpeg" alt="softmax-calculated" width="645" height="500" srcset="https://forums.fast.ai/uploads/default/optimized/3X/0/b/0bee952ff080de7e7b050fa9e81dd483414da494_2_645x500.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/0/b/0bee952ff080de7e7b050fa9e81dd483414da494_2_967x750.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/0/b/0bee952ff080de7e7b050fa9e81dd483414da494_2_1290x1000.jpeg 2x"></p>
<ul>
<li>What is the problem of softmax? How does it make the obvious wrong prediction when given a cat image to the bear classifier?</li>
<li>What can we do about the problem of the softmax above? (all prediction probabilities not adding up to 1). When do you use softmax and when not to?</li>
<li>What is the first part of the cross_entropy loss formula?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/6/1/613442943a389b25d30f73afe94a2172da533018_2_690x495.jpeg" alt="part1-crossentropy" width="690" height="495" srcset="https://forums.fast.ai/uploads/default/optimized/3X/6/1/613442943a389b25d30f73afe94a2172da533018_2_690x495.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/6/1/613442943a389b25d30f73afe94a2172da533018_2_1035x742.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/6/1/613442943a389b25d30f73afe94a2172da533018_2_1380x990.jpeg 2x"></p>
<ul>
<li>How to calculate cross-entropy from softmax?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/8/5/8546446e26005bcfb41f2dbea8f094ea6044c9cf_2_620x500.jpeg" alt="calc-cross-entropy" width="620" height="500" srcset="https://forums.fast.ai/uploads/default/optimized/3X/8/5/8546446e26005bcfb41f2dbea8f094ea6044c9cf_2_620x500.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/8/5/8546446e26005bcfb41f2dbea8f094ea6044c9cf_2_930x750.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/8/5/8546446e26005bcfb41f2dbea8f094ea6044c9cf_2_1240x1000.jpeg 2x"></p>
<ul>
<li>How to calculate binary-cross-entropy? How to understand its formula in predicting whether it is a cat or non-cat image? How to finally get the binary cross-entropy loss of a batch of 5 images?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/d/7/d7194a9f6353d643b0a9472756fa076dfd335597_2_690x473.jpeg" alt="binary-cross-entropy-calc" width="690" height="473" srcset="https://forums.fast.ai/uploads/default/optimized/3X/d/7/d7194a9f6353d643b0a9472756fa076dfd335597_2_690x473.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/d/7/d7194a9f6353d643b0a9472756fa076dfd335597_2_1035x709.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/d/7/d7194a9f6353d643b0a9472756fa076dfd335597_2_1380x946.jpeg 2x"></p>
<ul>
<li>What are two versions of cross-entropy in pytorch? and when to use each version? Which version do we use here?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/2/2/2245e4c140536aad1ef5b72a9543afda38ac65a5_2_690x264.jpeg" alt="cross-entropy-v1" width="690" height="264" srcset="https://forums.fast.ai/uploads/default/optimized/3X/2/2/2245e4c140536aad1ef5b72a9543afda38ac65a5_2_690x264.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/2/2/2245e4c140536aad1ef5b72a9543afda38ac65a5_2_1035x396.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/2/2/2245e4c140536aad1ef5b72a9543afda38ac65a5_2_1380x528.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/2/a/2ab6375dd73126e7635687a7fd3110b305eedded_2_690x114.png" alt="cross-entropy-v2" width="690" height="114" srcset="https://forums.fast.ai/uploads/default/optimized/3X/2/a/2ab6375dd73126e7635687a7fd3110b305eedded_2_690x114.png, https://forums.fast.ai/uploads/default/optimized/3X/2/a/2ab6375dd73126e7635687a7fd3110b305eedded_2_1035x171.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/2/a/2ab6375dd73126e7635687a7fd3110b305eedded_2_1380x228.png 2x"></p>
</section>
<section id="multi-target-activations" class="level2">
<h2 class="anchored" data-anchor-id="multi-target-activations">Multi-target activations</h2>
<ul>
<li>With a dataloader having two targets, our new model needs to be informed what exactly is the loss func, metrics, and the size of output?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/2/2/222cd9dc5c842f4a39c8046b85ac640c65664f82_2_690x182.jpeg" alt="model-specifications" width="690" height="182" srcset="https://forums.fast.ai/uploads/default/optimized/3X/2/2/222cd9dc5c842f4a39c8046b85ac640c65664f82_2_690x182.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/2/2/222cd9dc5c842f4a39c8046b85ac640c65664f82_2_1035x273.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/2/2/222cd9dc5c842f4a39c8046b85ac640c65664f82_2_1380x364.jpeg 2x"></p>
<ul>
<li>How to create a learner for prediction two targets or 20 items? How does a learner use disease and variety losses to know which 10 items are disease predictions and which 10 are variety predictions? How to combine two loss functions together? How to understand the combined loss?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/a/8/a877afc66e453b40fd4194e9070c33505470975e_2_690x127.png" alt="model-output-20" width="690" height="127" srcset="https://forums.fast.ai/uploads/default/optimized/3X/a/8/a877afc66e453b40fd4194e9070c33505470975e_2_690x127.png, https://forums.fast.ai/uploads/default/optimized/3X/a/8/a877afc66e453b40fd4194e9070c33505470975e_2_1035x190.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/a/8/a877afc66e453b40fd4194e9070c33505470975e_2_1380x254.png 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/6/6/665c97da404c8608e3d198db8812c895e5c93660_2_690x151.png" alt="loss-disease" width="690" height="151" srcset="https://forums.fast.ai/uploads/default/optimized/3X/6/6/665c97da404c8608e3d198db8812c895e5c93660_2_690x151.png, https://forums.fast.ai/uploads/default/optimized/3X/6/6/665c97da404c8608e3d198db8812c895e5c93660_2_1035x226.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/6/6/665c97da404c8608e3d198db8812c895e5c93660_2_1380x302.png 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/7/b/7b91f907777aa2cb90cf68c1878c903c444694f1_2_690x139.png" alt="loss-variety" width="690" height="139" srcset="https://forums.fast.ai/uploads/default/optimized/3X/7/b/7b91f907777aa2cb90cf68c1878c903c444694f1_2_690x139.png, https://forums.fast.ai/uploads/default/optimized/3X/7/b/7b91f907777aa2cb90cf68c1878c903c444694f1_2_1035x208.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/7/b/7b91f907777aa2cb90cf68c1878c903c444694f1_2_1380x278.png 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/a/6/a61748d386d2c9bcbcd6f2555a88f3d058529bcf_2_690x132.png" alt="combine-loss" width="690" height="132" srcset="https://forums.fast.ai/uploads/default/optimized/3X/a/6/a61748d386d2c9bcbcd6f2555a88f3d058529bcf_2_690x132.png, https://forums.fast.ai/uploads/default/optimized/3X/a/6/a61748d386d2c9bcbcd6f2555a88f3d058529bcf_2_1035x198.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/a/6/a61748d386d2c9bcbcd6f2555a88f3d058529bcf_2_1380x264.png 2x"></p>
<ul>
<li>How to calc error rate for disease types and variety types? How to put them together and display them during training?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/9/0/90658b962d8ec66766ed27c63af27424cabe6613_2_690x279.jpeg" alt="metrics-all-together" width="690" height="279" srcset="https://forums.fast.ai/uploads/default/optimized/3X/9/0/90658b962d8ec66766ed27c63af27424cabe6613_2_690x279.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/9/0/90658b962d8ec66766ed27c63af27424cabe6613_2_1035x418.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/9/0/90658b962d8ec66766ed27c63af27424cabe6613_2_1380x558.jpeg 2x"></p>
<ul>
<li>How to make the new learner and how did it train? Why the multi-task model didn’t improve and even a little worse than the previous model? Why training the multi-task model longer could improve the accuracy on disease prediction? Why predicting a second thing together could help improve the prediction of the first thing? Using multi-task model did improve the result in a Kaggle fish prediction competition Jeremy did before. What are the reasons or benefits for building multi-task models?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/0/f/0f18c85770f6737745434ab2b4812fc73854baa1_2_690x138.png" alt="train-combined-loss-metrics-all" width="690" height="138" srcset="https://forums.fast.ai/uploads/default/optimized/3X/0/f/0f18c85770f6737745434ab2b4812fc73854baa1_2_690x138.png, https://forums.fast.ai/uploads/default/optimized/3X/0/f/0f18c85770f6737745434ab2b4812fc73854baa1_2_1035x207.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/0/f/0f18c85770f6737745434ab2b4812fc73854baa1_2_1380x276.png 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/a/0/a0ce75a163a66d0c5f00875347ea1abdb3379fb7_2_690x363.jpeg" alt="result-little-worse" width="690" height="363" srcset="https://forums.fast.ai/uploads/default/optimized/3X/a/0/a0ce75a163a66d0c5f00875347ea1abdb3379fb7_2_690x363.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/a/0/a0ce75a163a66d0c5f00875347ea1abdb3379fb7_2_1035x544.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/a/0/a0ce75a163a66d0c5f00875347ea1abdb3379fb7_2_1380x726.jpeg 2x"></p>
<p>How to make multi-task modeling less confusing to you? (build a multi-task for Titanic dataset from scratch; explore and experiment this notebook) by Chris Said of binary-cross-entropy?</p>
</section>
<section id="collaborative-filtering" class="level2">
<h2 class="anchored" data-anchor-id="collaborative-filtering">Collaborative filtering</h2>
<ul>
<li>Collaborative filtering deep dive as chp 8 without change. What is the dataset used? Which version of the data we are using? How to read a tsv file using pandas? How to read/understand the dataset content/columns? recommendation system industry and Radek. How does Jeremy prefer to see the data? (cross tabulated) Why the image Jeremy talking about his preferred way of seeing the data has so few empty or missing data?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/e/c/ec8cf3b5f0af012bc4fca4cf1b82f55fab674aae_2_690x219.jpeg" alt="dataset" width="690" height="219" srcset="https://forums.fast.ai/uploads/default/optimized/3X/e/c/ec8cf3b5f0af012bc4fca4cf1b82f55fab674aae_2_690x219.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/e/c/ec8cf3b5f0af012bc4fca4cf1b82f55fab674aae_2_1035x328.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/e/c/ec8cf3b5f0af012bc4fca4cf1b82f55fab674aae_2_1380x438.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/a/9/a97bf7cf60d140f3b43748d771fd6a4fedb1cf3b_2_690x332.jpeg" alt="read-tsv" width="690" height="332" srcset="https://forums.fast.ai/uploads/default/optimized/3X/a/9/a97bf7cf60d140f3b43748d771fd6a4fedb1cf3b_2_690x332.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/a/9/a97bf7cf60d140f3b43748d771fd6a4fedb1cf3b_2_1035x498.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/a/9/a97bf7cf60d140f3b43748d771fd6a4fedb1cf3b_2_1380x664.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/6/4/64d971d762156b93315e3fd15e9f49cb0987f0e8_2_690x313.jpeg" alt="Jeremy-see-this-way" width="690" height="313" srcset="https://forums.fast.ai/uploads/default/optimized/3X/6/4/64d971d762156b93315e3fd15e9f49cb0987f0e8_2_690x313.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/6/4/64d971d762156b93315e3fd15e9f49cb0987f0e8_2_1035x469.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/6/4/64d971d762156b93315e3fd15e9f49cb0987f0e8_2_1380x626.jpeg 2x"></p>
<ul>
<li>How to fill in the missing data or gaps in the cross tabulated dataset? How to figure out whether a new user would like a particular movie which he/she has not watched before? Can we figure out what kind/genre of movie is the particular movie we are talking here? What does the type probabilities of a movie look like? What does a user’s preference probabilities look like? If we match the two sets of probabilities up, can we know how much does the user like the movie? How do we calculate that?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/5/9/592b2fdb4fb49e0dc932863c8035b5016cbf4425_2_690x188.jpeg" alt="types-movie" width="690" height="188" srcset="https://forums.fast.ai/uploads/default/optimized/3X/5/9/592b2fdb4fb49e0dc932863c8035b5016cbf4425_2_690x188.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/5/9/592b2fdb4fb49e0dc932863c8035b5016cbf4425_2_1035x282.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/5/9/592b2fdb4fb49e0dc932863c8035b5016cbf4425_2_1380x376.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/4/f/4f5531e5b7200f92d3a9af4247df3f504d1024af_2_690x292.jpeg" alt="user-preference-sum" width="690" height="292" srcset="https://forums.fast.ai/uploads/default/optimized/3X/4/f/4f5531e5b7200f92d3a9af4247df3f504d1024af_2_690x292.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/4/f/4f5531e5b7200f92d3a9af4247df3f504d1024af_2_1035x438.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/4/f/4f5531e5b7200f92d3a9af4247df3f504d1024af_2_1380x584.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/c/0/c00851f68905b8243d3b73658463e979ac2ee73b_2_690x304.png" alt="lower-value" width="690" height="304" srcset="https://forums.fast.ai/uploads/default/optimized/3X/c/0/c00851f68905b8243d3b73658463e979ac2ee73b_2_690x304.png, https://forums.fast.ai/uploads/default/optimized/3X/c/0/c00851f68905b8243d3b73658463e979ac2ee73b_2_1035x456.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/c/0/c00851f68905b8243d3b73658463e979ac2ee73b_2_1380x608.png 2x"></p>
<ul>
<li>So far so good, what is the problem of the approach of doing dot product between user preference probabilities and movie type probabilities to find out our new user’s rating of the movie? (we don’t know neither of the probabilities). How are we going to deal with this problem? Can we create such movie type probabilities without knowing even the types?</li>
<li>What is the latent factors? If I don’t know anything about the movies, can we use SGD (stochastic gradient descent) to find them? Can we create a random 5 numbers as a movie’s 5 latent factors for describing the types of the movie, and figure them out later? Can we create latent factors for each user too? Now how to calc the probability of a user likes a movie? (mmult or dot product between two groups of latent factors).</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/3/2/329b0259a8e6b1d8e4bd225dbf378efe9e189be0_2_690x456.jpeg" alt="latent-factors-movie" width="690" height="456" srcset="https://forums.fast.ai/uploads/default/optimized/3X/3/2/329b0259a8e6b1d8e4bd225dbf378efe9e189be0_2_690x456.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/3/2/329b0259a8e6b1d8e4bd225dbf378efe9e189be0_2_1035x684.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/3/2/329b0259a8e6b1d8e4bd225dbf378efe9e189be0_2_1380x912.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/d/c/dc1b0d2e8e766a0750c94881c77bad576fee0fdd_2_690x386.jpeg" alt="latent-factor-for-all-movies" width="690" height="386" srcset="https://forums.fast.ai/uploads/default/optimized/3X/d/c/dc1b0d2e8e766a0750c94881c77bad576fee0fdd_2_690x386.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/d/c/dc1b0d2e8e766a0750c94881c77bad576fee0fdd_2_1035x579.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/d/c/dc1b0d2e8e766a0750c94881c77bad576fee0fdd_2_1380x772.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/original/3X/0/4/043d85eca9ca0e2198ba5f1b6fa629ba470cebfe.jpeg" alt="latent-factors-user" width="554" height="500"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/7/6/7628a9b85d34d0383be3c904f3a7c0c49e9a2484_2_690x405.jpeg" alt="matrix-multiply-dot-product" width="690" height="405" srcset="https://forums.fast.ai/uploads/default/optimized/3X/7/6/7628a9b85d34d0383be3c904f3a7c0c49e9a2484_2_690x405.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/7/6/7628a9b85d34d0383be3c904f3a7c0c49e9a2484_2_1035x607.jpeg 1.5x, https://forums.fast.ai/uploads/default/original/3X/7/6/7628a9b85d34d0383be3c904f3a7c0c49e9a2484.jpeg 2x"></p>
<ul>
<li>Now the mmult or dot product can give us the prediction of how much a user likes a movie, so we can compare predictions with true label. What to do when there is a missing label or data? (we make the prediction empty or zero). Can we use SGD to improve the latent factors by comparing predictions with labels using a loss function? How to use excel solver to update latent factors using SGD and the loss?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/e/f/ef6ab1294f1093259e4c5df1c921703361fdd384_2_670x500.jpeg" alt="missing-data-empty" width="670" height="500" srcset="https://forums.fast.ai/uploads/default/optimized/3X/e/f/ef6ab1294f1093259e4c5df1c921703361fdd384_2_670x500.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/e/f/ef6ab1294f1093259e4c5df1c921703361fdd384_2_1005x750.jpeg 1.5x, https://forums.fast.ai/uploads/default/original/3X/e/f/ef6ab1294f1093259e4c5df1c921703361fdd384.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/0/4/04fbaa36a4c360959c0a826caba9592b0b5514c9_2_523x500.jpeg" alt="make-missing-zero" width="523" height="500" srcset="https://forums.fast.ai/uploads/default/optimized/3X/0/4/04fbaa36a4c360959c0a826caba9592b0b5514c9_2_523x500.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/0/4/04fbaa36a4c360959c0a826caba9592b0b5514c9_2_784x750.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/0/4/04fbaa36a4c360959c0a826caba9592b0b5514c9_2_1046x1000.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/7/5/755438b324e3799f6ce766c713c6b5036ae8bf81_2_690x362.jpeg" alt="the-loss-pred-label" width="690" height="362" srcset="https://forums.fast.ai/uploads/default/optimized/3X/7/5/755438b324e3799f6ce766c713c6b5036ae8bf81_2_690x362.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/7/5/755438b324e3799f6ce766c713c6b5036ae8bf81_2_1035x543.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/7/5/755438b324e3799f6ce766c713c6b5036ae8bf81_2_1380x724.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/0/1/0159ecab4e53556ebdad0b406b13b73805ad6616_2_690x427.jpeg" alt="excel-solver" width="690" height="427" srcset="https://forums.fast.ai/uploads/default/optimized/3X/0/1/0159ecab4e53556ebdad0b406b13b73805ad6616_2_690x427.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/0/1/0159ecab4e53556ebdad0b406b13b73805ad6616_2_1035x640.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/0/1/0159ecab4e53556ebdad0b406b13b73805ad6616_2_1380x854.jpeg 2x"></p>
<p>Why excel is so slow on calc gradients with even small dataset? What is the basis of collaborative filtering? (if we know A likes (a, b, c) and B likes (a, b, c), then if A likes (d, e), maybe B likes (d, e) too). - Is the cosine of an angle between two vectors is the same thing as the dot product? - How do we do the things above in pytorch as they have different data format from excel? What does the dataset would look like in pytorch?</p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/b/a/ba1b5333c95a803967c9b6b3b5922f6200aec599_2_690x326.jpeg" alt="collab-dataset-pytorch" width="690" height="326" srcset="https://forums.fast.ai/uploads/default/optimized/3X/b/a/ba1b5333c95a803967c9b6b3b5922f6200aec599_2_690x326.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/b/a/ba1b5333c95a803967c9b6b3b5922f6200aec599_2_1035x489.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/b/a/ba1b5333c95a803967c9b6b3b5922f6200aec599_2_1380x652.jpeg 2x"></p>
</section>
<section id="embeddings" class="level2">
<h2 class="anchored" data-anchor-id="embeddings">Embeddings</h2>
<ul>
<li>What is embedding? What are embedding matrix, user embeddings, and movie embeddings? (embeddings = look up something in an array). The more intimidating words created in a field, the less intimidating the field actually is.</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/2/c/2c3081a4e2471d0dc86d6a4e76751662ebb27739_2_690x279.jpeg" alt="embeddings" width="690" height="279" srcset="https://forums.fast.ai/uploads/default/optimized/3X/2/c/2c3081a4e2471d0dc86d6a4e76751662ebb27739_2_690x279.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/2/c/2c3081a4e2471d0dc86d6a4e76751662ebb27739_2_1035x418.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/2/c/2c3081a4e2471d0dc86d6a4e76751662ebb27739_2_1380x558.jpeg 2x"></p>
<ul>
<li>What does our dataset look like before building a dataloaders on it? How to create a dataloaders for collaborative filtering using <code>CollabDataloaders.from_df</code>? What does its <code>show_batch</code> look like? How do we create the user and movie latent factors algetother?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/7/5/758eb7bc56f1562e7dbe2525c359cc80ae55cc23_2_610x500.jpeg" alt="dataset-movie-dataloader" width="610" height="500" srcset="https://forums.fast.ai/uploads/default/optimized/3X/7/5/758eb7bc56f1562e7dbe2525c359cc80ae55cc23_2_610x500.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/7/5/758eb7bc56f1562e7dbe2525c359cc80ae55cc23_2_915x750.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/7/5/758eb7bc56f1562e7dbe2525c359cc80ae55cc23_2_1220x1000.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/8/f/8f28b35c026c563c233282bbe7393cb9af0d4b67_2_690x172.jpeg" alt="build-dataloader-cf" width="690" height="172" srcset="https://forums.fast.ai/uploads/default/optimized/3X/8/f/8f28b35c026c563c233282bbe7393cb9af0d4b67_2_690x172.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/8/f/8f28b35c026c563c233282bbe7393cb9af0d4b67_2_1035x258.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/8/f/8f28b35c026c563c233282bbe7393cb9af0d4b67_2_1380x344.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/a/9/a9d0bdf31e8734a7c0ed40edd1ef3e36e53c2298_2_690x397.jpeg" alt="cf-show-batch" width="690" height="397" srcset="https://forums.fast.ai/uploads/default/optimized/3X/a/9/a9d0bdf31e8734a7c0ed40edd1ef3e36e53c2298_2_690x397.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/a/9/a9d0bdf31e8734a7c0ed40edd1ef3e36e53c2298_2_1035x595.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/a/9/a9d0bdf31e8734a7c0ed40edd1ef3e36e53c2298_2_1380x794.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/7/8/7838f8430473f724a2e3e5156a25f7d6bda54b72_2_690x211.png" alt="create-latent-factors" width="690" height="211" srcset="https://forums.fast.ai/uploads/default/optimized/3X/7/8/7838f8430473f724a2e3e5156a25f7d6bda54b72_2_690x211.png, https://forums.fast.ai/uploads/default/optimized/3X/7/8/7838f8430473f724a2e3e5156a25f7d6bda54b72_2_1035x316.png 1.5x, https://forums.fast.ai/uploads/default/original/3X/7/8/7838f8430473f724a2e3e5156a25f7d6bda54b72.png 2x"></p>
<ul>
<li>How do you choose the number of latent factors in fastai?</li>
<li>How to understand looking up in excel for latent factors and doing dot product with one-hot embeddings are actually the same thing? Can we think of embeddings as a computational shortcut to multiply something by a one-hot-encoded vector? Can we think of embedding as a cook math trick of speeding up the matrix multiplication with dummy variables (without creating dummy variables nor one-hot encoded vector).</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/1/f/1f254bae3830f4f79cc07b6c16a0511ac63bbfaf_2_690x345.png" alt="look-up-dot-product" width="690" height="345" srcset="https://forums.fast.ai/uploads/default/optimized/3X/1/f/1f254bae3830f4f79cc07b6c16a0511ac63bbfaf_2_690x345.png, https://forums.fast.ai/uploads/default/optimized/3X/1/f/1f254bae3830f4f79cc07b6c16a0511ac63bbfaf_2_1035x517.png 1.5x, https://forums.fast.ai/uploads/default/original/3X/1/f/1f254bae3830f4f79cc07b6c16a0511ac63bbfaf.png 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/6/c/6c1dd2073754edda0a1bfe7acc38db80506396ba_2_690x243.jpeg" alt="one-hot-encoding-look-up" width="690" height="243" srcset="https://forums.fast.ai/uploads/default/optimized/3X/6/c/6c1dd2073754edda0a1bfe7acc38db80506396ba_2_690x243.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/6/c/6c1dd2073754edda0a1bfe7acc38db80506396ba_2_1035x364.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/6/c/6c1dd2073754edda0a1bfe7acc38db80506396ba_2_1380x486.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/b/0/b0b6205134341c68799a9739bf55c105edc870dd_2_690x373.jpeg" alt="mmultiplication" width="690" height="373" srcset="https://forums.fast.ai/uploads/default/optimized/3X/b/0/b0b6205134341c68799a9739bf55c105edc870dd_2_690x373.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/b/0/b0b6205134341c68799a9739bf55c105edc870dd_2_1035x559.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/b/0/b0b6205134341c68799a9739bf55c105edc870dd_2_1380x746.jpeg 2x"></p>
</section>
<section id="object-oriented-programming" class="level2">
<h2 class="anchored" data-anchor-id="object-oriented-programming">Object oriented programming</h2>
<ul>
<li>How to build a collaborative filtering model from scratch? How do we create a class? (as a model is a class). How do we initiate a class object by <code>__init__</code>? Does <code>__init__</code> tell us what parameters to give in order to create a class instance? How does the class function <code>say</code> do? What is a super class? Where do we put it when creating a class? What does it give us? What is the super class (Module) for pytorch and fastai to use when creating a class? What does the <code>DotProduct</code> class look like?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/f/3/f39bb45a2a9aeec4c50c2230dbe546bbbd8ef903_2_690x244.jpeg" alt="learn-create-class" width="690" height="244" srcset="https://forums.fast.ai/uploads/default/optimized/3X/f/3/f39bb45a2a9aeec4c50c2230dbe546bbbd8ef903_2_690x244.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/f/3/f39bb45a2a9aeec4c50c2230dbe546bbbd8ef903_2_1035x366.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/f/3/f39bb45a2a9aeec4c50c2230dbe546bbbd8ef903_2_1380x488.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/5/2/52e85a3c36db128d42865dbb4714073ae54b1415_2_690x157.png" alt="class-example" width="690" height="157" srcset="https://forums.fast.ai/uploads/default/optimized/3X/5/2/52e85a3c36db128d42865dbb4714073ae54b1415_2_690x157.png, https://forums.fast.ai/uploads/default/optimized/3X/5/2/52e85a3c36db128d42865dbb4714073ae54b1415_2_1035x235.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/5/2/52e85a3c36db128d42865dbb4714073ae54b1415_2_1380x314.png 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/9/5/958dd964f8d2dc24382de7a0799e03c960a6e43a_2_690x302.jpeg" alt="super-class" width="690" height="302" srcset="https://forums.fast.ai/uploads/default/optimized/3X/9/5/958dd964f8d2dc24382de7a0799e03c960a6e43a_2_690x302.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/9/5/958dd964f8d2dc24382de7a0799e03c960a6e43a_2_1035x453.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/9/5/958dd964f8d2dc24382de7a0799e03c960a6e43a_2_1380x604.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/4/9/49d96bdbc7ea8dc9621aba7e72e9a901de712307_2_690x215.jpeg" alt="Dot-product-class" width="690" height="215" srcset="https://forums.fast.ai/uploads/default/optimized/3X/4/9/49d96bdbc7ea8dc9621aba7e72e9a901de712307_2_690x215.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/4/9/49d96bdbc7ea8dc9621aba7e72e9a901de712307_2_1035x322.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/4/9/49d96bdbc7ea8dc9621aba7e72e9a901de712307_2_1380x430.jpeg 2x"></p>
<ul>
<li>How to understand the <code>forward</code> function in the <code>DotProduct</code> class? What does <code>.sum(dim=1)</code> mean? (sum each row).</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/7/b/7befe31f450692edb4c008b80ea0b59b2d54b2b8_2_690x220.jpeg" alt="forward-understanding" width="690" height="220" srcset="https://forums.fast.ai/uploads/default/optimized/3X/7/b/7befe31f450692edb4c008b80ea0b59b2d54b2b8_2_690x220.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/7/b/7befe31f450692edb4c008b80ea0b59b2d54b2b8_2_1035x330.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/7/b/7befe31f450692edb4c008b80ea0b59b2d54b2b8_2_1380x440.jpeg 2x"></p>
</section>
<section id="improving-collaborative-filtering" class="level2">
<h2 class="anchored" data-anchor-id="improving-collaborative-filtering">Improving collaborative filtering</h2>
<ul>
<li>How to create a collab learner and start training? The training is very fast even on CPU.</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/4/2/426c364888d12db84268e7fa5f3feac9babb2d55_2_690x175.png" alt="one-batch-look-like" width="690" height="175" srcset="https://forums.fast.ai/uploads/default/optimized/3X/4/2/426c364888d12db84268e7fa5f3feac9babb2d55_2_690x175.png, https://forums.fast.ai/uploads/default/optimized/3X/4/2/426c364888d12db84268e7fa5f3feac9babb2d55_2_1035x262.png 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/4/2/426c364888d12db84268e7fa5f3feac9babb2d55_2_1380x350.png 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/9/8/980f8b59b9e8339f4b22f4786d9eb3f8c1c6f627_2_690x262.jpeg" alt="collab-learner" width="690" height="262" srcset="https://forums.fast.ai/uploads/default/optimized/3X/9/8/980f8b59b9e8339f4b22f4786d9eb3f8c1c6f627_2_690x262.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/9/8/980f8b59b9e8339f4b22f4786d9eb3f8c1c6f627_2_1035x393.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/9/8/980f8b59b9e8339f4b22f4786d9eb3f8c1c6f627_2_1380x524.jpeg 2x"></p>
<ul>
<li>Why this collab model above is not great? (people who give ratings are people who love movies, they don’t rarely give 1, but many high ratings. Whereas the predictions have many occassions with ratings over 5). Review the sigmoid usage. How can we do sigmoid transformation to the predictions? How does this sigmoid work? Why do we use the up limit of the range <code>5.5</code> instead of <code>5</code>? Does adding sigmoid always improve the result?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/e/a/ea31571a3891e95cfc3ce1b1b52007dff4b7a94b_2_690x245.jpeg" alt="sigmoid-transform" width="690" height="245" srcset="https://forums.fast.ai/uploads/default/optimized/3X/e/a/ea31571a3891e95cfc3ce1b1b52007dff4b7a94b_2_690x245.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/e/a/ea31571a3891e95cfc3ce1b1b52007dff4b7a94b_2_1035x367.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/e/a/ea31571a3891e95cfc3ce1b1b52007dff4b7a94b_2_1380x490.jpeg 2x"></p>
<ul>
<li>What interesting things did Jeremy observe from the dataset? (some users like to give high ratings to all movies, some tend to dislike all movies). Can we add one bias value to both user and movie latent factors to explain this interesting observation? How to use the bias factors inside the collab model?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/b/b/bbb126f8323ca2c266f1c1867b57c7acb46f4bcd_2_690x282.jpeg" alt="user-tendency" width="690" height="282" srcset="https://forums.fast.ai/uploads/default/optimized/3X/b/b/bbb126f8323ca2c266f1c1867b57c7acb46f4bcd_2_690x282.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/b/b/bbb126f8323ca2c266f1c1867b57c7acb46f4bcd_2_1035x423.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/b/b/bbb126f8323ca2c266f1c1867b57c7acb46f4bcd_2_1380x564.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/8/8/88b82221d76673d397e4f1e605f2d80134e344c4_2_690x448.jpeg" alt="bias-factor" width="690" height="448" srcset="https://forums.fast.ai/uploads/default/optimized/3X/8/8/88b82221d76673d397e4f1e605f2d80134e344c4_2_690x448.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/8/8/88b82221d76673d397e4f1e605f2d80134e344c4_2_1035x672.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/8/8/88b82221d76673d397e4f1e605f2d80134e344c4_2_1380x896.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/0/d/0d68c8c1c93606101295312c8c9e96aaf69f308d_2_690x319.jpeg" alt="adding-biases-to-prediction" width="690" height="319" srcset="https://forums.fast.ai/uploads/default/optimized/3X/0/d/0d68c8c1c93606101295312c8c9e96aaf69f308d_2_690x319.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/0/d/0d68c8c1c93606101295312c8c9e96aaf69f308d_2_1035x478.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/0/d/0d68c8c1c93606101295312c8c9e96aaf69f308d_2_1380x638.jpeg 2x"></p>
<ul>
<li>Why did the upgraded model with bias get worse? (overfitting).</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/1/5/15be1b4b512651c13de6f325e98ab67837020696_2_690x268.jpeg" alt="overfitting-collab" width="690" height="268" srcset="https://forums.fast.ai/uploads/default/optimized/3X/1/5/15be1b4b512651c13de6f325e98ab67837020696_2_690x268.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/1/5/15be1b4b512651c13de6f325e98ab67837020696_2_1035x402.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/1/5/15be1b4b512651c13de6f325e98ab67837020696_2_1380x536.jpeg 2x"></p>
</section>
<section id="weight-decay" class="level2">
<h2 class="anchored" data-anchor-id="weight-decay">Weight decay</h2>
<ul>
<li>What is weight decay and How does it help? How to understand weight decay in solving the problem of overfitting?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/2/b/2ba175a248170dc42de2cb2a3e49a8a3c1afa777_2_690x290.jpeg" alt="weight-decay" width="690" height="290" srcset="https://forums.fast.ai/uploads/default/optimized/3X/2/b/2ba175a248170dc42de2cb2a3e49a8a3c1afa777_2_690x290.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/2/b/2ba175a248170dc42de2cb2a3e49a8a3c1afa777_2_1035x435.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/2/b/2ba175a248170dc42de2cb2a3e49a8a3c1afa777_2_1380x580.jpeg 2x"></p>
<ul>
<li>How to actually use weight decay in fastai code? Does fastai have a good default for collaborative filtering like CV? How does Jeremy suggest to find the appropriate <code>wd</code> value for your own dataset?</li>
</ul>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/2/d/2d240b5fcf7b6b92643497067176a390d41778d7_2_690x268.jpeg" alt="weight-decay2" width="690" height="268" srcset="https://forums.fast.ai/uploads/default/optimized/3X/2/d/2d240b5fcf7b6b92643497067176a390d41778d7_2_690x268.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/2/d/2d240b5fcf7b6b92643497067176a390d41778d7_2_1035x402.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/2/d/2d240b5fcf7b6b92643497067176a390d41778d7_2_1380x536.jpeg 2x"></p>
<p><img src="https://forums.fast.ai/uploads/default/optimized/3X/e/7/e728e7640b79a3ead582d8feefe518e1e8b999d5_2_690x260.jpeg" alt="weight-decay3" width="690" height="260" srcset="https://forums.fast.ai/uploads/default/optimized/3X/e/7/e728e7640b79a3ead582d8feefe518e1e8b999d5_2_690x260.jpeg, https://forums.fast.ai/uploads/default/optimized/3X/e/7/e728e7640b79a3ead582d8feefe518e1e8b999d5_2_1035x390.jpeg 1.5x, https://forums.fast.ai/uploads/default/optimized/3X/e/7/e728e7640b79a3ead582d8feefe518e1e8b999d5_2_1380x520.jpeg 2x"></p>
<ul>
<li>What is regularization? What’s wrong when the weights having high values or low values? How does weight decay help balance?</li>
<li>More questions: any other rules other than Jeremy’s rule of thumb on number of latent factors, and recommendation on average rating is viable only when there are many metadata.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../Lessons/Summaries/lesson6.html" class="pagination-link  aria-label=" lesson="" 6"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Lesson 6</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../Lessons/Summaries/lesson8.html" class="pagination-link" aria-label="Lesson 8">
        <span class="nav-page-text">Lesson 8</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>